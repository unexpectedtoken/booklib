Ext.define("Ext.i18n.reader.Property",{extend:"Ext.data.reader.Json",alias:"reader.i18n.property",getResponseData:function(a){return a},getData:function(k){var c=[],b,h,g=this.readLines(k),a=g.length;for(var d=0;d<a;d++){var e=g[d].search(/[\s:=]/);b={value:this.clearValueExtraChars(g[d].substring(e+1)),key:this.clearKeyExtraChars(g[d].substring(0,e))};c[d]=b}return c},clearKeyExtraChars:function(a){return(a?a.replace(/[:=]/gi,""):"")},clearValueExtraChars:function(a){return(a?a.replace(/\\\s*\n/gi,""):"")},readLines:function(b){var a=b.responseText;return(a?a.match(/.*(.*\\\s*\n)+.*|^((?!^\s*[#!]).).*$/gim):[])}});Ext.define("Ext.i18n.reader.Json",{extend:"Ext.data.reader.Json",alias:"reader.i18n.json",extractData:function(l){var k=this,d=[],c=k.getModel(),a=l.length,o,n,f,m,e,b,h,g;if(!l.length&&Ext.isObject(l)){o=k.getKeys(l);a=o.length}for(g=0;g<a;g++){n=o[g];f=n.split(".");for(j=0,m=l;j<f.length;j++){m=m[f[j]]}b={key:n,value:m};h=new c(b);h.phantom=false;d.push(h)}return d},getKeys:function(f,b){var d=this,a,c=[];function e(k,h){var i=(h||""),g;for(g in k){if(k.hasOwnProperty(g)){i=(i?i+".":"")+g;if(Ext.isObject(k[g])){i=e(k[g],i)}return i}}}for(a in f){if(f.hasOwnProperty(a)){if(Ext.isObject(f[a])){c.push(e(f[a],a))}else{c.push(a)}}}return c}});Ext.define("Ext.i18n.Bundle",{extend:"Ext.data.Store",requires:["Ext.app.Application","Ext.i18n.reader.Property","Ext.i18n.reader.Json"],defaultLanguage:"en-US",autoLoad:false,model:Ext.define("Ext.i18n._modelBundle",{extend:"Ext.data.Model",fields:["key","value"],idProperty:"key"}),bundle:"message",format:"property",path:"resources",constructor:function(c){c=c||{};var d=this,f=d.formatLanguageCode(c.lang||d.guessLanguage()),a=(c.noCache!==false),b,e;d.language=f;d.bundle=c.bundle||d.bundle;d.path=c.path||d.path;d.format=c.format||d.format;b=this.buildURL(f);delete c.lang;delete c.noCache;Ext.applyIf(c,{proxy:{type:"ajax",url:b,noCache:a,reader:{type:"i18n."+d.format},groupParam:"",limitParam:"",startParam:""}});d.callParent([c]);d.on("load",d.onBundleLoad,d);d.getProxy().on("exception",this.loadParent,this,{single:true})},guessLanguage:function(){return(navigator.language||navigator.browserLanguage||navigator.userLanguage||this.defaultLanguage)},getMsg:function(d){var b=[].splice.call(arguments,1),e=this.getById(d),a=d+".undefined",c;if(e){a=Ext.util.Format.htmlDecode(e.get("value"));if(b){c=[a].concat(b);a=Ext.String.format.apply(null,c)}}return a},onBundleLoad:function(b,a,c,d){if(c){this.fireEvent("loaded")}},onProxyLoad:function(a){if(a.getRecords()){this.callParent(arguments)}},getResourceExtension:function(){return this.format==="property"?".properties":".json"},buildURL:function(b){var a="";if(this.path){a+=this.path+"/"}a+=this.bundle;if(b){a+="_"+b}a+=this.getResourceExtension();return a},loadParent:function(){this.getProxy().url=this.buildURL();this.load()},formatLanguageCode:function(d){var c=d.split("-"),b,a;b=(c[0])?c[0].toLowerCase():"";a=(c[1])?c[1].toUpperCase():"";return c.length>1?[b,a].join("-"):b}},function(){Ext.override(Ext.Base,{initConfig:function(d){var c=this,a=c.getConfigurator(),b;c.initConfig=Ext.emptyFn;c.initialConfig=d||{};for(b in d){if(d.hasOwnProperty(b)&&d[b]&&typeof d[b]==="object"&&d[b].type&&d[b].type==="bundle"){d[b]=Ext.i18n.Bundle.instance.getMsg(d[b].key)}}a.configure(c,d);return c}});Ext.override(Ext.app.Application,{onBeforeLaunch:function(){var c=this,b=this.onBeforeLaunch.$previous,a;if(c.bundle){c.bundle=Ext.create("Ext.i18n.Bundle",Ext.apply({autoLoad:true,listeners:{loaded:function(){b.apply(c)}}},c.bundle));Ext.i18n.Bundle.instance=c.bundle}else{c.callOverridden()}}})});